<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>manage</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>
<style>
    .header a{
        text-decoration: none;

    }
    code{
        font-size: 12px;
    }
    h3{
        font-size: 30px;
        font-weight: 400;
    }
    h4{
        font-size: 27px;
        font-weight: 400;
    }
    h5{
        font-size: 24px;
        font-weight: 400;
    }
    h6{
        font-size: 20px;
        font-weight: 400;   
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
    }
    table, th, td {
        border: 1px solid rgba(0, 0, 0, 0.214);
    }
    th, td {
        padding: 8px;
        text-align: left;
    }
    th {
        background-color: #f2f2f23d;
    }

    ul {
            list-style-type: none;
        }
        .directory, .file {
            margin-left: 20px;
        }
        .directory::before {
            content: 'ğŸ“‚ ';
        }
        .file::before {
            content: 'ğŸ“„ ';
        }
    a{
        text-decoration: underline;
        text-decoration-style: dashed;
        text-decoration-color: rgba(94, 94, 94, 0.739);
    }
    strong{
        color: rgba(255, 68, 0, 0.783);
        font-size:20px;
    }
</style>
<body>
    <div class="header">
        <div class="header-container">
                <div class="logo">
                    <!-- <svg class="pl" width="100" height="100" viewBox="0 0 400 400">
                        <circle class="pl__ring pl__ring--a" cx="120" cy="120" r="105" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 660" stroke-dashoffset="-330" stroke-linecap="round"></circle>
                        <circle class="pl__ring pl__ring--b" cx="120" cy="120" r="35" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 220" stroke-dashoffset="-110" stroke-linecap="round"></circle>
                        <circle class="pl__ring pl__ring--c" cx="85" cy="120" r="70" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 440" stroke-linecap="round"></circle>
                        <circle class="pl__ring pl__ring--d" cx="155" cy="120" r="70" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 440" stroke-linecap="round"></circle>
                    </svg> -->
                    <!-- <p>å­¦æœŸè®¡åˆ’åˆ¶ä½œ</p> -->
                    <img src="assets/img/å­¦æœŸç³»ç»Ÿ500x200.png" alt="logo" width="150" height="60">

                 </div>            
            <div class="menu">
                <ul>
                    <li><a href="./index.html">è®¡åˆ’ä¸»é¡µ</a></li>
                    <li><a href="./create.html">åˆ¶ä½œè®¡åˆ’</a></li>
                    <li><a href="./instruction.html">è½¯ä»¶è¯´æ˜</a></li>
                </ul>
            </div>
            <div class="login">
                <a href="./server.html">åå°ç®¡ç†</a>
                <a href="./model.html">æ¨¡æ¿æ›´æ”¹</a>
            </div>
        </div>


    </div>
    

    <div class="page-content">


        <div class="index-instruction-section">
                    <div class="index-instruction-content">
                    <p class="heading">ç®¡ç†ï¼š
                    </p>
                        <p>
                            Useful linksï¼š
                        </p>
                        
                        <p>
                            &emsp;&emsp;é‡‘æ•°æ®:&emsp;<a href="https://www.jinshuju.net/home" target="_blank">DataBase</a>
                        </p><p>
                            &emsp;&emsp; Aliyun:&emsp;<a href="https://ecs.console.aliyun.com" target="_blank">ECS sys.</a>
                        </p><p>
                            &emsp;&emsp; github:&emsp;æ­¤å†…å®¹ä»…ç®¡ç†å‘˜å¯è®¿é—®
                        </p>
                        <!-- <p>
                            &emsp;&emsp; Aliyun:&emsp;<a href="https://ecs.console.aliyun.com" target="_blank">ECS sys.</a>
                        </p><p>
                            &emsp;&emsp; github:&emsp;<a href="https://github.com/xhy783/studyPlan-1.1" target="_blank">Project here</a>
                        </p> -->


                            
                        <p>é‡‘æ•°æ®ï¼š</p>
                        <p>&emsp;&emsp;ç›®å‰å¹´çº§é€‰é¡¹æ ¼å¼ï¼š'ä¸­ç­', 'å°ç­', 'å¤§ç­', 'å¹¼å°è¡”æ¥', 'åˆä¸€', 'åˆäºŒ', 'åˆä¸‰', <br>&emsp;&emsp;'é«˜ä¸€', 'é«˜äºŒ', 'é«˜ä¸‰', '1å¹´çº§', '2å¹´çº§' ,'3å¹´çº§' ,'4å¹´çº§' ,'5å¹´çº§' ,'6å¹´çº§' </p>
                        <p>&emsp;&emsp;åˆ—åæ ¼å¼ï¼š'ç›®å‰å¹´çº§', 'æ‚¨çš„å¾®ä¿¡æ˜µç§°ï¼ˆæ–¹ä¾¿å‘æ‚¨è®¡åˆ’ï¼‰', 'è¯­æ–‡æˆç»©','æ•°å­¦æˆç»©','è‹±è¯­æˆç»©',</p>
                        <p>&emsp;&emsp;â€œè¯­æ–‡æˆç»©â€ã€â€œæ•°å­¦æˆç»©â€ã€â€œè‹±è¯­æˆç»©â€æ ¼å¼ï¼šå¡«ç©ºç®€ç­”é¢˜--æ•°å­—ã€æœ€å°å€¼0ã€æœ€å¤§å€¼100ã€ä¿ç•™å°æ•°ä½æ•°ï¼š1</p>
                        <p>&emsp;&emsp;éœ€è¦åœ¨è‹±è¯­æˆç»©é—®é¢˜å‰æ·»åŠ ä¸€ä¸ªé—®é¢˜ï¼Œâ€œæ˜¯å¦å¼€å§‹å­¦ä¹ è‹±è¯­â€ï¼Œé€‰é¡¹ä¸ºâ€œæ˜¯â€å’Œâ€œå¦â€</p>
                        <p>è§„åˆ™è®¾ç½®ï¼š</p>
                        <p>&emsp;&emsp;é—®é¢˜â€œæ˜¯å¦å¼€å§‹å­¦ä¹ è‹±è¯­â€ï¼Œç­”æ¡ˆä¸ºâ€œæ˜¯â€ï¼Œåˆ™æ˜¾ç¤ºé¢˜ç›®è‹±è¯­æˆç»©</p>
                        <p>&emsp;&emsp;é—®é¢˜â€œç›®å‰å¹´çº§â€ï¼Œç­”æ¡ˆä¸ºâ€œ1å¹´çº§â€ã€â€œ2å¹´çº§â€ï¼Œåˆ™æ˜¾ç¤ºâ€œè¯­æ–‡æˆç»©â€ã€â€œæ•°å­¦æˆç»©â€ã€â€œæ˜¯å¦å¼€å§‹å­¦ä¹ è‹±è¯­â€</p>
                        <p>&emsp;&emsp;é—®é¢˜â€œç›®å‰å¹´çº§â€ï¼Œç­”æ¡ˆä¸ºâ€œ3å¹´çº§â€ã€â€œ4å¹´çº§â€ã€â€œ5å¹´çº§â€ã€â€œ6å¹´çº§â€ï¼Œåˆ™æ˜¾ç¤ºâ€œè¯­æ–‡æˆç»©â€ã€â€œæ•°å­¦æˆç»©â€ã€â€œè‹±è¯­æˆç»©â€</p>
                        <p>&emsp;&emsp;<strong>å¿…é¡»ä¸¥æ ¼æŒ‰ç…§è¿™ä¸ªæ ¼å¼å‘½åï¼!å»ºè®®ç›´æ¥å¤åˆ¶è¿™ä¸ªæŒ‡å¼•é‡Œçš„åˆ—åã€‚
                        </strong></p>




                        <p>æ”¹è®¡åˆ’æ¨¡æ¿æ–¹æ³•ï¼š</p>
                        <p>&emsp;&emsp;ç‚¹å‡»ä¸Šæ–¹å·¥å…·æ é‡Œçš„<a href="./model.html">æ¨¡æ¿æ›´æ”¹ï¼ˆç‚¹æˆ‘ä¹Ÿå¯ä»¥å“¦ï¼‰</a>ï¼Œåˆ é™¤æ—§é¡¹ç›®ä¸Šä¼ æ–°é¡¹ç›®ã€‚
                        </p><p>&emsp;&emsp;<strong>ï¼æ¯æ¬¡ä¸Šä¼ å°½é‡ä¸è¦è¶…è¿‡åä¸ªæ¨¡æ¿ï¼</strong>

                        </p>

                        <!-- <p>&emsp;&emsp;æç¤º: Project Directory Structure</p> -->
<!-- <ul>
    <li class="directory">studyPlan-1.1/
        <ul>
            <li class="directory">public/
                <ul>
                    <li class="file">index.html</li>
                    <li class="file">...</li>
                </ul>
            </li>
            <li class="directory">source/
                <ul>
                    <li class="file">ä¸­ç­å­¦ä¹ è®¡åˆ’.xlsx</li>
                    <li class="file">åˆä¸€å­¦ä¹ è®¡åˆ’.xlsx</li>
                    <li class="file">1å¹´çº§å­¦ä¹ è®¡åˆ’done.xlsx</li>
                    <li class="file">...</li> 
                </ul>
            </li>
            <li class="directory">uploads/</li>
            <li class="directory">processed/</li>
            <li class="file">server.js</li>
            <li class="file">package.json</li>
        </ul>
    </li>
</ul> -->
                            <p>
                                Deployment:
                            </p>
                            <div>æ­¤å†…å®¹ä»…ç®¡ç†å‘˜å¯è®¿é—®</div>

                            <!-- <p>
                        1.é˜¿é‡Œäº‘ï¼š
                    </p> -->
                    <!-- <p>
                        &emsp;&emsp; <strong>ç³»ç»Ÿæœ‰æ•ˆæœŸåˆ°10æœˆ1å·ï¼Œåœ¨æ­¤å‰æ— ç»­è´¹è‡ªåŠ¨é‡Šæ”¾ã€‚</strong>
                    </p> -->
                    <!-- <p>
                        &emsp;&emsp; 1.ç³»ç»Ÿéƒ¨ç½²åœ¨é˜¿é‡Œäº‘ECSä¸Šï¼Œè‰è“ç†Šæ‰‹æœºæ‰«ç 
                    </p>
                    <p>
                        &emsp;&emsp;&emsp;  ä½ç½®ï¼šååŒ—2ï¼ˆåŒ—äº¬ï¼‰
                    </p><p>
                        &emsp;&emsp;&emsp;  å®ä¾‹ï¼ši-2ze729yjvd9vjc45qa1eï¼Œ
                    </p><p>
                        &emsp;&emsp;&emsp;  å®‰å…¨ç»„IDï¼šsg-2ze78247pezscertol49 
                </p> -->

                <!-- <p>
                    &emsp;&emsp;&emsp;  å…¥ç«™ç«¯å£ï¼šæš‘æœŸè®¡åˆ’ä¸º3000ï¼Œå­¦æœŸè®¡åˆ’ä¸º4000
        </p>                <p>
            &emsp;&emsp; Workbenchå¯†ç ï¼šè§ç¾¤å†…æ–‡æ¡£
        </p><p>
            &emsp;&emsp;&emsp;  æ”¾è¡Œå…¥ç«™IPè¡¨ï¼š
            </p><p>
                &emsp;&emsp;&emsp;  è‡ªä¸»åˆ›æ–°å¤§å¦ TAL-guestï¼š111.204.240.2 
                </p>

                <p>
                    &emsp;&emsp;  2.æ–‡ä»¶éƒ¨ç½²ä½ç½®ä¸ºï¼š/home/xes/studyPlan-1.1 (ç»å¯¹è·¯å¾„)
                </p>
                <p>
                    &emsp;&emsp;  3.éƒ¨ç½²å·¥å…·ï¼špm2 è¿›ç¨‹åç§°ï¼šæš‘æœŸè®¡åˆ’ï¼šxes-plan å­¦æœŸè®¡åˆ’ï¼š xes-plan2
                    
                </p> -->
                <p>
                    &emsp;&emsp; 	pm2æŒ‡ä»¤ï¼š
                    
                </p>             
            
<table>&emsp;&emsp;
    <tr>
        <th>æŒ‡ä»¤</th>
        <th>è¯´æ˜</th>
        <th>ç¤ºä¾‹</th>
    </tr>
    <tr>
        <td>npm install -g pm2</td>
        <td>å®‰è£… PM2</td>
        <td><code>npm install -g pm2</code></td>
    </tr>
    <tr>
        <td>pm2 start &lt;file&gt;</td>
        <td>å¯åŠ¨åº”ç”¨</td>
        <td><code>pm2 start server.js --name study-plan-app</code></td>
    </tr>
    <tr>
        <td>pm2 list</td>
        <td>æŸ¥çœ‹åº”ç”¨çŠ¶æ€</td>
        <td><code>pm2 list</code></td>
    </tr>
    <tr>
        <td>pm2 restart &lt;name/id&gt;</td>
        <td>é‡å¯åº”ç”¨</td>
        <td><code>pm2 restart study-plan-app</code><br><code>pm2 restart &lt;id&gt;</code></td>
    </tr>
    <tr>
        <td>pm2 stop &lt;name/id&gt;</td>
        <td>åœæ­¢åº”ç”¨</td>
        <td><code>pm2 stop study-plan-app</code><br><code>pm2 stop &lt;id&gt;</code></td>
    </tr>
    <tr>
        <td>pm2 delete &lt;name/id&gt;</td>
        <td>åˆ é™¤åº”ç”¨</td>
        <td><code>pm2 delete study-plan-app</code><br><code>pm2 delete &lt;id&gt;</code></td>
    </tr>
    <tr>
        <td>pm2 logs &lt;name/id&gt;</td>
        <td>æŸ¥çœ‹æ—¥å¿—</td>
        <td><code>pm2 logs study-plan-app</code><br><code>pm2 logs &lt;id&gt;</code></td>
    </tr>
    <tr>
        <td>pm2 save</td>
        <td>ä¿å­˜è¿›ç¨‹åˆ—è¡¨ï¼Œä¾¿äºé‡å¯åæ¢å¤</td>
        <td><code>pm2 save</code></td>
    </tr>
    <tr>
        <td>pm2 startup</td>
        <td>å¯ç”¨ç³»ç»Ÿå¯åŠ¨è„šæœ¬ï¼Œç¡®ä¿æœåŠ¡å™¨é‡å¯ååº”ç”¨è‡ªåŠ¨å¯åŠ¨</td>
        <td><code>pm2 startup</code></td>
    </tr>
    <tr>
        <td>pm2 monit</td>
        <td>ç›‘æ§åº”ç”¨æ€§èƒ½</td>
        <td><code>pm2 monit</code></td>
    </tr>
    <tr>
        <td>pm2 reload &lt;name/id&gt;</td>
        <td>0 ç§’åœæœºé‡è½½åº”ç”¨ï¼ˆå¦‚æœåº”ç”¨æ”¯æŒï¼‰</td>
        <td><code>pm2 reload study-plan-app</code><br><code>pm2 reload &lt;id&gt;</code></td>
    </tr>
</table>&emsp;&emsp;&emsp;

  
<!-- <p>
    &emsp;&emsp; 	å…·ä½“éƒ¨ç½²æ–¹æ³•è§<a href="https://github.com/xhy783/studyPlan-1.1/blob/main/README.md" target="_blank">githubREADMEæ–‡æ¡£</a>ï¼ˆå¤åˆ¶åœ¨ä¸‹æ–¹äº†ï¼‰ï¼Œäº‘ç«¯å’Œæœ¬åœ°éƒ¨ç½²æ–¹æ³•åŸºæœ¬ä¸€æ ·ï¼Œè®°å¾—è®¾ç½®å®‰å…¨ç»„ï¼
</p>     -->

<h3>Study Plan Management System</h3>
<!-- <p>ä¸‹é¢æœ‰ä¸­æ–‡ç‰ˆ</p> -->


<h4>Overview</h4>
<p>This project is a web-based file management system designed for our teachers to upload user information via CSV files. The system generates study plans for each parent based on the uploaded data. Additionally, it includes a file management system allowing administrators to update source files, which let teachers change templates.</p>

<h4>Features</h4>
<ul>
    <li>Upload CSV Files: Teachers can upload CSV files containing user information.</li>
    <li>Generate Study Plans: The system processes the CSV file and generates personalized study plans for each parent.</li>
    <li>File Management: Administrators can upload, view, and delete template files in the source directory.</li>
    <li>Multi-level Handling: Handles different student performance levels (e.g., 111, 222, 333) (no need during Summery Vacation).</li>
</ul>

<h4>Prerequisites</h4>
<ul>
    <li>Node.js (version 12 or higher)</li>
    <li>npm (Node Package Manager)</li>
</ul>

<h4>Installation</h4>

<!-- <h5>Windows</h5>
<ol>
    <li>Install Node.js:
        <p>Download and install Node.js from <a href="https://nodejs.org/" target="_blank">nodejs.org</a>.</p>
    </li>
    <li>Clone the repository:
        <pre><code>git clone https://github.com/xhy783/studyPlan-1.2.git
            cd /home/xes/studyPlan-1.1</code></pre>
            <p>æ­¤å†…å®¹ä»…ç®¡ç†å‘˜å¯è®¿é—®</p>

    </li>
    <li>Install dependencies:
        <pre><code>npm install</code></pre>
    </li>
</ol>

<h5>macOS</h5>
<ol>
    <li>Install Node.js:
        <p>You can use Homebrew (recommended) to install Node.js. If you don't have Homebrew installed, you can install it from <a href="https://brew.sh/" target="_blank">brew.sh</a>.</p>
        <pre><code>brew install node</code></pre>
    </li>
    <li>Clone the repository:
        <pre><code>git clone https://github.com/xhy783/studyPlan-1.2.git
            cd /home/xes/studyPlan-1.2</code></pre>
            <p>æ­¤å†…å®¹ä»…ç®¡ç†å‘˜å¯è®¿é—®</p>

    </li>
    <li>Install dependencies:
        <pre><code>npm install</code></pre>
    </li>
</ol>

<h5>Linux</h5> -->
<ol>
    <li>Install Node.js:
        <p>On Debian-based distributions (e.g., Ubuntu), you can use:</p>
        <pre><code>sudo apt update
sudo apt install nodejs npm</code></pre>
        <p>On RHEL-based distributions (e.g., CentOS), you can use:</p>
        <pre><code>sudo yum install nodejs npm</code></pre>
    </li>
    <li>Clone the repository:
        <!-- <pre><code>git clone https://github.com/xhy783/studyPlan-1.2.git
            cd /home/xes/studyPlan-1.2</code></pre> -->
            <p>æ­¤å†…å®¹ä»…ç®¡ç†å‘˜å¯è®¿é—®</p>

    </li>
    <li>Install dependencies:
        <pre><code>npm install</code></pre>
    </li>
</ol>

<h4>Usage</h4>

<h5>Start the Server</h5>
<p>In the project directory, run the following command:</p>
<pre><code>node server.js</code></pre>

<h5>Access the Web Interface</h5>
<p>Open your web browser and navigate to <code>http://localhost:4000/model.html</code>.</p>

<h4>Project Structure</h4>
<pre><code>studyPlan-1.1/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ create.html
â”‚   â”œâ”€â”€ instruction.html
â”‚   â”œâ”€â”€ server.html
â”‚   â””â”€â”€ model.html
â”œâ”€â”€ uploads/
â”‚   â””â”€â”€ (uploaded files)
â”œâ”€â”€ source/
â”‚   â”œâ”€â”€ ä¸­ç­æš‘æœŸå­¦ä¹ è®¡åˆ’.xlsx
â”‚   â”œâ”€â”€ åˆä¸€æš‘æœŸå­¦ä¹ è®¡åˆ’.xlsx
â”‚   â”œâ”€â”€ 1231å¹´çº§æš‘æœŸå­¦ä¹ è®¡åˆ’done.xlsx
â”‚   â”œâ”€â”€ é«˜ä¸€æš‘æœŸå­¦ä¹ è®¡åˆ’.xlsx
â”‚   â””â”€â”€ ...
â”œâ”€â”€ processed/
â”‚   â””â”€â”€ (processed files for download)
â”œâ”€â”€ server.js
â”œâ”€â”€ package.json
â””â”€â”€ README.md</code></pre>

<h4>Modifying Templates</h4>

<h5>Updating Templates</h5>
<p>To update the templates, replace the existing files in the <code>source</code> directory with the new templates. The templates should follow the naming convention required by the specific logic in the <code>server.js</code> file. Or you can just easily go to the model.html and delete old templates and upload new templates (See Uploading New Templates).</p>

<h5>Code Changes</h5>
<!-- <p>If we don't change the logic of Summer vacation plans like all plans of the same grade possess the same content, we don't need to change codes. If the template filenames or logic for selecting templates change, you need to update the <code>processFile</code> function in <code>server.js</code>.</p>

<h6>Example: Grade 1-6 with Levels 111-333</h6>
<pre><code>const processFile = (filePath, processedFolder, callback) => {
    const results = [];
    fs.createReadStream(filePath)
        .pipe(csv())
        .on('data', (data) => results.push(data))
        .on('end', () => {
            results.forEach(row => {
                const grade = row['ç›®å‰å¹´çº§'];
                const wechatId = row['æ‚¨çš„å¾®ä¿¡æ˜µç§°ï¼ˆæ–¹ä¾¿å‘æ‚¨è®¡åˆ’ï¼‰'];
                let code = '';
                let sourceFile = '';

                if (['1å¹´çº§', '2å¹´çº§', '3å¹´çº§', '4å¹´çº§', '5å¹´çº§', '6å¹´çº§'].includes(grade)) {
                    const chineseScore = row['è¯­æ–‡æˆç»©'];
                    const mathScore = row['æ•°å­¦æˆç»©'];
                    const englishScore = row['è‹±è¯­æˆç»©'];

                    if (chineseScore === '96ä»¥ä¸Š') {
                        code += '1';
                    } else if (chineseScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (mathScore === '96ä»¥ä¸Š') {
                        code += '1';
                    } else if (mathScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (englishScore === '96ä»¥ä¸Š') {
                        code += '1';
                    } else if (englishScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    sourceFile = `${code}${grade[0]}å¹´çº§å­¦ä¹ è®¡åˆ’done.xlsx`;
                } else {
                    sourceFile = `${grade}æš‘æœŸå­¦ä¹ è®¡åˆ’.xlsx`;
                }

                const sourcePath = path.join(__dirname, 'source', sourceFile);
                const targetFile = `${grade}æš‘æœŸå­¦ä¹ è®¡åˆ’-${wechatId}.xlsx`;
                const targetPath = path.join(processedFolder, targetFile);

                try {
                    fs.copyFileSync(sourcePath, targetPath);
                    console.log(`File copied: ${targetPath}`);
                } catch (err) {
                    console.error(`Error while copying ${sourcePath} to ${targetPath}:`, err);
                }
            });
            callback();
        });
};</code></pre> -->
<!-- 
<h6>Example: Middle School with Levels</h6>
<p>If middle school grades (e.g., åˆä¸€, åˆäºŒ, åˆä¸‰) also require level-specific templates, update the <code>processFile</code> function accordingly:</p>
<pre><code>const processFile = (filePath, processedFolder, callback) => {
    const results = [];
    fs.createReadStream(filePath)
        .pipe(csv())
        .on('data', (data) => results.push(data))
        .on('end', () => {
            results.forEach(row => {
                const grade = row['ç›®å‰å¹´çº§'];
                const wechatId = row['æ‚¨çš„å¾®ä¿¡æ˜µç§°ï¼ˆæ–¹ä¾¿å‘æ‚¨è®¡åˆ’ï¼‰'];
                let code = '';
                let sourceFile = '';

                if (['åˆä¸€', 'åˆäºŒ', 'åˆä¸‰'].includes(grade)) {
                    const chineseScore = row['è¯­æ–‡æˆç»©'];
                    const mathScore = row['æ•°å­¦æˆç»©'];
                    const englishScore = row['è‹±è¯­æˆç»©'];

                    if (chineseScore === '96ä»¥ä¸Š') {
                        code += '1';
                    } else if (chineseScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (mathScore === '96ä»¥ä¸Š') {
                        code += '1';
                    } else if (mathScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (englishScore === '96ä»¥ä¸Š') {
                        code += '1';
                    } else if (englishScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    sourceFile = `${code}${grade}å­¦ä¹ è®¡åˆ’done.xlsx`;
                } else {
                    sourceFile = `${grade}æš‘æœŸå­¦ä¹ è®¡åˆ’.xlsx`;
                }

                const sourcePath = path.join(__dirname, 'source', sourceFile);
                const targetFile = `${grade}æš‘æœŸå­¦ä¹ è®¡åˆ’-${wechatId}.xlsx`;
                const targetPath = path.join(processedFolder, targetFile);

                try {
                    fs.copyFileSync(sourcePath, targetPath);
                    console.log(`File copied: ${targetPath}`);
                } catch (err) {
                    console.error(`Error while copying ${sourcePath} to ${targetPath}:`, err);
                }
            });
            callback();
        });
};</code></pre> -->
<p>æ­¤å†…å®¹ä»…ç®¡ç†å‘˜å¯è®¿é—®</p>

<h5>Uploading New Templates</h5>
<!-- <ol>
    <li>Navigate to the File Management Page:
        <p>Open your web browser and go to <code>http://localhost:4000/model.html</code> (or IP of aliyun server, depends on where you want to deploy this system).</p>
    </li>
    <li>Upload New Templates:
        <p>Use the file upload interface to upload new template files. Ensure the filenames follow the required naming conventions.</p>
    </li>
    <li>Update the Code:
        <p>If the logic for selecting templates has changed, update the <code>processFile</code> function in <code>server.js</code>.</p>
    </li>
    <li>Restart the Server:
        <p>After making changes to <code>server.js</code>, restart the server:</p>
        <pre><code>node server.js</code></pre>
        <p>(on aliyun's server I use pm2 to manage processes so I can do <code>pm2 restart xes-plan2</code>)</p>
    </li>
</ol> -->
<p>æ­¤å†…å®¹ä»…ç®¡ç†å‘˜å¯è®¿é—®</p>


<h4>More Information</h4>
<p>Should you have any questions or need more information, please contact <a href="mailto:xhy783@outlook.fr">xhy783@outlook.fr</a>.</p>
       
<!-- 

<h3>å­¦ä¹ è®¡åˆ’ç®¡ç†ç³»ç»Ÿ</h3>

<h4>æ¦‚è¿°</h4>
<p>æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºWebçš„æ–‡ä»¶ç®¡ç†ç³»ç»Ÿï¼Œæ—¨åœ¨è®©æ•™å¸ˆé€šè¿‡CSVæ–‡ä»¶ä¸Šä¼ ç”¨æˆ·ä¿¡æ¯ã€‚ç³»ç»Ÿæ ¹æ®ä¸Šä¼ çš„æ•°æ®ä¸ºæ¯ä½å®¶é•¿ç”Ÿæˆå­¦ä¹ è®¡åˆ’ã€‚æ­¤å¤–ï¼Œç³»ç»Ÿè¿˜åŒ…æ‹¬ä¸€ä¸ªæ–‡ä»¶ç®¡ç†ç³»ç»Ÿï¼Œå…è®¸ç®¡ç†å‘˜æ›´æ–°æºæ–‡ä»¶ï¼Œä»è€Œè®©æ•™å¸ˆæ›´æ”¹æ¨¡æ¿ã€‚</p>

<h4>åŠŸèƒ½</h4>
<ul>
    <li>ä¸Šä¼ CSVæ–‡ä»¶ï¼šæ•™å¸ˆå¯ä»¥ä¸Šä¼ åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„CSVæ–‡ä»¶ã€‚</li>
    <li>ç”Ÿæˆå­¦ä¹ è®¡åˆ’ï¼šç³»ç»Ÿå¤„ç†CSVæ–‡ä»¶å¹¶ä¸ºæ¯ä½å®¶é•¿ç”Ÿæˆä¸ªæ€§åŒ–çš„å­¦ä¹ è®¡åˆ’ã€‚</li>
    <li>æ–‡ä»¶ç®¡ç†ï¼šç®¡ç†å‘˜å¯ä»¥åœ¨æºç›®å½•ä¸­ä¸Šä¼ ã€æŸ¥çœ‹å’Œåˆ é™¤æ¨¡æ¿æ–‡ä»¶ã€‚</li>
    <li>å¤šå±‚æ¬¡å¤„ç†ï¼šå¤„ç†ä¸åŒå­¦ç”Ÿçš„æˆç»©ç­‰çº§ï¼ˆä¾‹å¦‚ï¼Œ111ï¼Œ222ï¼Œ333ï¼‰ï¼ˆæš‘æœŸä¸éœ€è¦ï¼‰ã€‚</li>
</ul>

<h4>å…ˆå†³æ¡ä»¶</h4>
<ul>
    <li>Node.jsï¼ˆç‰ˆæœ¬12æˆ–æ›´é«˜ï¼‰</li>
    <li>npmï¼ˆNodeåŒ…ç®¡ç†å™¨ï¼‰</li>
</ul>

<h4>å®‰è£…</h4>

<h5>Windows</h5>
<ol>
    <li>å®‰è£…Node.jsï¼š
        <p>ä» <a href="https://nodejs.org/" target="_blank">nodejs.org</a> ä¸‹è½½å¹¶å®‰è£…Node.jsã€‚</p>
    </li>
    <li>å…‹éš†ä»“åº“ï¼š
        <pre><code>git clone https://github.com/xhy783/studyPlan-1.2.git
            cd /home/xes/studyPlan-1.2</code></pre>
    </li>
    <li>å®‰è£…ä¾èµ–ï¼š
        <pre><code>npm install</code></pre>
    </li>
</ol>

<h5>macOS</h5>
<ol>
    <li>å®‰è£…Node.jsï¼š
        <p>ä½ å¯ä»¥ä½¿ç”¨Homebrewï¼ˆæ¨èï¼‰å®‰è£…Node.jsã€‚å¦‚æœä½ æ²¡æœ‰å®‰è£…Homebrewï¼Œå¯ä»¥ä» <a href="https://brew.sh/" target="_blank">brew.sh</a> å®‰è£…ã€‚</p>
        <pre><code>brew install node</code></pre>
    </li>
    <li>å…‹éš†ä»“åº“ï¼š
        <pre><code>git clone https://github.com/xhy783/studyPlan-1.2.git
            cd /home/xes/studyPlan-1.2</code></pre>
    </li>
    <li>å®‰è£…ä¾èµ–ï¼š
        <pre><code>npm install</code></pre>
    </li>
</ol>

<h5>Linux</h5>
<ol>
    <li>å®‰è£…Node.jsï¼š
        <p>åœ¨åŸºäºDebiançš„å‘è¡Œç‰ˆï¼ˆä¾‹å¦‚Ubuntuï¼‰ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>
        <pre><code>sudo apt update
sudo apt install nodejs npm</code></pre>
        <p>åœ¨åŸºäºRHELçš„å‘è¡Œç‰ˆï¼ˆä¾‹å¦‚CentOSï¼‰ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>
        <pre><code>sudo yum install nodejs npm</code></pre>
    </li>
    <li>å…‹éš†ä»“åº“ï¼š
        <pre><code>git clone https://github.com/xhy783/studyPlan-1.2.git
            cd /home/xes/studyPlan-1.2</code></pre>
    </li>
    <li>å®‰è£…ä¾èµ–ï¼š
        <pre><code>npm install</code></pre>
    </li>
</ol>

<h4>ä½¿ç”¨æ–¹æ³•</h4>

<h5>å¯åŠ¨æœåŠ¡å™¨</h5>
<p>åœ¨é¡¹ç›®ç›®å½•ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code>node server.js</code></pre>

<h5>è®¿é—®Webç•Œé¢</h5>
<p>æ‰“å¼€ä½ çš„Webæµè§ˆå™¨ï¼Œå¯¼èˆªåˆ° <code>http://localhost:4000/model.html</code>ã€‚</p>

<h4>é¡¹ç›®ç»“æ„</h4>
<pre><code>studyPlan-1.1/
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ create.html
â”‚   â”œâ”€â”€ instruction.html
â”‚   â”œâ”€â”€ server.html
â”‚   â””â”€â”€ model.html
â”œâ”€â”€ uploads/
â”‚   â””â”€â”€ (ä¸Šä¼ çš„æ–‡ä»¶)
â”œâ”€â”€ source/
â”‚   â”œâ”€â”€ ä¸­ç­å­¦ä¹ è®¡åˆ’.xlsx
â”‚   â”œâ”€â”€ åˆä¸€å­¦ä¹ è®¡åˆ’.xlsx
â”‚   â”œâ”€â”€ 1231å¹´çº§å­¦ä¹ è®¡åˆ’done.xlsx
â”‚   â”œâ”€â”€ é«˜ä¸€å­¦ä¹ è®¡åˆ’.xlsx
â”‚   â””â”€â”€ ...
â”œâ”€â”€ processed/
â”‚   â””â”€â”€ (å¤„ç†åçš„æ–‡ä»¶ç”¨äºä¸‹è½½)
â”œâ”€â”€ server.js
â”œâ”€â”€ package.json
â””â”€â”€ README.md</code></pre>

<h4>ä¿®æ”¹æ¨¡æ¿</h4>

<h5>æ›´æ–°æ¨¡æ¿</h5>
<p>è¦æ›´æ–°æ¨¡æ¿ï¼Œè¯·å°† <code>source</code> ç›®å½•ä¸­çš„ç°æœ‰æ–‡ä»¶æ›¿æ¢ä¸ºæ–°æ¨¡æ¿ã€‚æ¨¡æ¿åº”éµå¾ª <code>server.js</code> æ–‡ä»¶ä¸­ç‰¹å®šé€»è¾‘è¦æ±‚çš„å‘½åçº¦å®šã€‚æˆ–è€…ï¼Œä½ å¯ä»¥ç›´æ¥è®¿é—® <code>model.html</code>ï¼Œåˆ é™¤æ—§æ¨¡æ¿å¹¶ä¸Šä¼ æ–°æ¨¡æ¿ï¼ˆè§ä¸Šä¼ æ–°æ¨¡æ¿ï¼‰ã€‚</p>

<h5>ä»£ç æ›´æ”¹</h5>
<p>å¦‚æœæˆ‘ä»¬ä¸æ›´æ”¹æš‘æœŸè®¡åˆ’çš„é€»è¾‘ï¼Œä¾‹å¦‚åŒä¸€å¹´çº§çš„æ‰€æœ‰è®¡åˆ’å†…å®¹ç›¸åŒï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸éœ€è¦æ›´æ”¹ä»£ç ã€‚å¦‚æœæ¨¡æ¿æ–‡ä»¶åæˆ–é€‰æ‹©æ¨¡æ¿çš„é€»è¾‘å‘ç”Ÿå˜åŒ–ï¼Œä½ éœ€è¦æ›´æ–° <code>server.js</code> ä¸­çš„ <code>processFile</code> å‡½æ•°ã€‚</p>

<h6>ç¤ºä¾‹ï¼šç­‰çº§1-6å’Œçº§åˆ«111-333</h6>
<pre><code>const processFile = (filePath, processedFolder, callback) => {
    const results = [];
    fs.createReadStream(filePath)
        .pipe(csv())
        .on('data', (data) => results.push(data))
        .on('end', () => {
            results.forEach(row => {
                const grade = row['ç›®å‰å¹´çº§'];
                const wechatId = row['æ‚¨çš„å¾®ä¿¡æ˜µç§°ï¼ˆæ–¹ä¾¿å‘æ‚¨è®¡åˆ’ï¼‰'];
                let code = '';
                let sourceFile = '';

                if (['1å¹´çº§', '2å¹´çº§', '3å¹´çº§', '4å¹´çº§', '5å¹´çº§', '6å¹´çº§'].includes(grade)) {
                    const chineseScore = row['è¯­æ–‡æˆç»©'];
                    const mathScore = row['æ•°å­¦æˆç»©'];
                    const englishScore = row['è‹±è¯­æˆç»©'];

                    if (chineseScore === '96ä»¥ä¸Š') {
                        code += '1';
                    } else if (chineseScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (mathScore === '96ä»¥ä¸Š') {
                        code += '1';
                    } else if (mathScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (englishScore === '96ä»¥ä¸Š') {
                        code += '1';
                    } else if (englishScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    sourceFile = `${code}${grade[0]}å¹´çº§å­¦ä¹ è®¡åˆ’done.xlsx`;
                } else {
                    sourceFile = `${grade}æš‘æœŸå­¦ä¹ è®¡åˆ’.xlsx`;
                }

                const sourcePath = path.join(__dirname, 'source', sourceFile);
                const targetFile = `${grade}æš‘æœŸå­¦ä¹ è®¡åˆ’-${wechatId}.xlsx`;
                const targetPath = path.join(processedFolder, targetFile);

                try {
                    fs.copyFileSync(sourcePath, targetPath);
                    console.log(`File copied: ${targetPath}`);
                } catch (err) {
                    console.error(`Error while copying ${sourcePath} to ${targetPath}:`, err);
                }
            });
            callback();
        });
};</code></pre>

<h6>ç¤ºä¾‹ï¼šåˆä¸­å’Œçº§åˆ«</h6>
<p>å¦‚æœåˆä¸­å¹´çº§ï¼ˆä¾‹å¦‚ï¼Œåˆä¸€ã€åˆäºŒã€åˆä¸‰ï¼‰ä¹Ÿéœ€è¦ç‰¹å®šçº§åˆ«çš„æ¨¡æ¿ï¼Œè¯·ç›¸åº”æ›´æ–° <code>processFile</code> å‡½æ•°ï¼š</p>
<pre><code>const processFile = (filePath, processedFolder, callback) => {
    const results = [];
    fs.createReadStream(filePath)
        .pipe(csv())
        .on('data', (data) => results.push(data))
        .on('end', () => {
            results.forEach(row => {
                const grade = row['ç›®å‰å¹´çº§'];
                const wechatId = row['æ‚¨çš„å¾®ä¿¡æ˜µç§°ï¼ˆæ–¹ä¾¿å‘æ‚¨è®¡åˆ’ï¼‰'];
                let code = '';
                let sourceFile = '';

                if (['åˆä¸€', 'åˆäºŒ', 'åˆä¸‰'].includes(grade)) {
                    const chineseScore = row['è¯­æ–‡æˆç»©'];
                    const mathScore = row['æ•°å­¦æˆç»©'];
                    const englishScore = row['è‹±è¯­æˆç»©'];

                    if (chineseScore === '96ä»¥ä¸Š') {
                        code += '1';
                    } else if (chineseScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (mathScore === '96ä»¥ä¸Š') {
                        code += '1';
                    } else if (mathScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (englishScore === '96ä»¥ä¸Š') {
                        code += '1';
                    } else if (englishScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    sourceFile = `${code}${grade}å­¦ä¹ è®¡åˆ’done.xlsx`;
                } else {
                    sourceFile = `${grade}æš‘æœŸå­¦ä¹ è®¡åˆ’.xlsx`;
                }

                const sourcePath = path.join(__dirname, 'source', sourceFile);
                const targetFile = `${grade}æš‘æœŸå­¦ä¹ è®¡åˆ’-${wechatId}.xlsx`;
                const targetPath = path.join(processedFolder, targetFile);

                try {
                    fs.copyFileSync(sourcePath, targetPath);
                    console.log(`File copied: ${targetPath}`);
                } catch (err) {
                    console.error(`Error while copying ${sourcePath} to ${targetPath}:`, err);
                }
            });
            callback();
        });
};</code></pre>

<h5>ä¸Šä¼ æ–°æ¨¡æ¿</h5>
<ol>
    <li>å¯¼èˆªåˆ°æ–‡ä»¶ç®¡ç†é¡µé¢ï¼š
        <p>æ‰“å¼€ä½ çš„Webæµè§ˆå™¨å¹¶è½¬åˆ° <code>http://localhost:4000/model.html</code>ï¼ˆæˆ–è€…æ ¹æ®ä½ éƒ¨ç½²ç³»ç»Ÿçš„ä½ç½®ä½¿ç”¨é˜¿é‡Œäº‘æœåŠ¡å™¨çš„IPåœ°å€ï¼‰ã€‚</p>
    </li>
    <li>ä¸Šä¼ æ–°æ¨¡æ¿ï¼š
        <p>ä½¿ç”¨æ–‡ä»¶ä¸Šä¼ ç•Œé¢ä¸Šä¼ æ–°æ¨¡æ¿æ–‡ä»¶ã€‚ç¡®ä¿æ–‡ä»¶åéµå¾ªæ‰€éœ€çš„å‘½åçº¦å®šã€‚</p>
    </li>
    <li>æ›´æ–°ä»£ç ï¼š
        <p>å¦‚æœé€‰æ‹©æ¨¡æ¿çš„é€»è¾‘å‘ç”Ÿäº†å˜åŒ–ï¼Œè¯·æ›´æ–° <code>server.js</code> ä¸­çš„ <code>processFile</code> å‡½æ•°ã€‚</p>
    </li>
    <li>é‡å¯æœåŠ¡å™¨ï¼š
        <p>åœ¨ä¿®æ”¹ <code>server.js</code> åï¼Œé‡å¯æœåŠ¡å™¨ï¼š</p>
        <pre><code>node server.js</code></pre>
        <p>ï¼ˆåœ¨é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸Šï¼Œæˆ‘ä½¿ç”¨ pm2 æ¥ç®¡ç†è¿›ç¨‹ï¼Œå› æ­¤å¯ä»¥æ‰§è¡Œ <code>pm2 restart xes-plan2</code>ï¼‰</p>
    </li>
</ol>

<h4>æ›´å¤šä¿¡æ¯</h4>
<p>å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦æ›´å¤šä¿¡æ¯ï¼Œè¯·è”ç³» <a href="mailto:xhy783@outlook.fr">xhy783@outlook.fr</a>ã€‚</p>

            
            </div>


                          
        </div>

    </div>

        <div class="footer-notice">
            V1.2 å­¦æœŸè®¡åˆ’ä¸“ç”¨        </div>
        
                    
    </div>
<script>    document.addEventListener('DOMContentLoaded', function() {
    var saveButton = document.getElementById('Trip');

    saveButton.addEventListener('click', function() {
        window.location.href = 'package.html';
    });
});
</script>
<script>
    function uploadFile() {
        var fileInput = document.getElementById('fileToUpload');
        var file = fileInput.files[0];
        var formData = new FormData();
        formData.append('fileToUpload', file);

        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'upload', true);

        xhr.onload = function () {
            if (xhr.status === 200) {
                var link = document.createElement('a');
                link.href = window.URL.createObjectURL(new Blob([xhr.response], {type: 'application/zip'}));
                link.download = 'processed_files.zip';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                document.getElementById('status').innerText = 'File uploaded and processed successfully!';
            } else {
                document.getElementById('status').innerText = 'File upload failed!';
            }
        };

        xhr.responseType = 'blob';
        xhr.send(formData);
    }
</script>



</body>
</html>

 -->
