<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>manage</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
</head>
<style>
    .header a{
        text-decoration: none;

    }
    code{
        font-size: 12px;
    }
    h3{
        font-size: 30px;
        font-weight: 400;
    }
    h4{
        font-size: 27px;
        font-weight: 400;
    }
    h5{
        font-size: 24px;
        font-weight: 400;
    }
    h6{
        font-size: 20px;
        font-weight: 400;   
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
    }
    table, th, td {
        border: 1px solid rgba(0, 0, 0, 0.214);
    }
    th, td {
        padding: 8px;
        text-align: left;
    }
    th {
        background-color: #f2f2f23d;
    }

    ul {
            list-style-type: none;
        }
        .directory, .file {
            margin-left: 20px;
        }
        .directory::before {
            content: '📂 ';
        }
        .file::before {
            content: '📄 ';
        }
    a{
        text-decoration: underline;
        text-decoration-style: dashed;
        text-decoration-color: rgba(94, 94, 94, 0.739);
    }
    strong{
        color: rgba(255, 68, 0, 0.783);
        font-size:20px;
    }
</style>
<body>
    <div class="header">
        <div class="header-container">
                <div class="logo">
                    <!-- <svg class="pl" width="100" height="100" viewBox="0 0 400 400">
                        <circle class="pl__ring pl__ring--a" cx="120" cy="120" r="105" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 660" stroke-dashoffset="-330" stroke-linecap="round"></circle>
                        <circle class="pl__ring pl__ring--b" cx="120" cy="120" r="35" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 220" stroke-dashoffset="-110" stroke-linecap="round"></circle>
                        <circle class="pl__ring pl__ring--c" cx="85" cy="120" r="70" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 440" stroke-linecap="round"></circle>
                        <circle class="pl__ring pl__ring--d" cx="155" cy="120" r="70" fill="none" stroke="#000" stroke-width="20" stroke-dasharray="0 440" stroke-linecap="round"></circle>
                    </svg> -->
                    <!-- <p>学期计划制作</p> -->
                    <img src="assets/img/学期系统500x200.png" alt="logo" width="150" height="60">

                 </div>            
            <div class="menu">
                <ul>
                    <li><a href="./index.html">计划主页</a></li>
                    <li><a href="./create.html">制作计划</a></li>
                    <li><a href="./instruction.html">软件说明</a></li>
                </ul>
            </div>
            <div class="login">
                <a href="./server.html">后台管理</a>
                <a href="./model.html">模板更改</a>
            </div>
        </div>


    </div>
    

    <div class="page-content">


        <div class="index-instruction-section">
                    <div class="index-instruction-content">
                    <p class="heading">管理：
                    </p>
                        <p>
                            Useful links：
                        </p>
                        
                        <p>
                            &emsp;&emsp;金数据:&emsp;<a href="https://www.jinshuju.net/home" target="_blank">DataBase</a>
                        </p><p>
                            &emsp;&emsp; Aliyun:&emsp;<a href="https://ecs.console.aliyun.com" target="_blank">ECS sys.</a>
                        </p><p>
                            &emsp;&emsp; github:&emsp;此内容仅管理员可访问
                        </p>
                        <!-- <p>
                            &emsp;&emsp; Aliyun:&emsp;<a href="https://ecs.console.aliyun.com" target="_blank">ECS sys.</a>
                        </p><p>
                            &emsp;&emsp; github:&emsp;<a href="https://github.com/xhy783/studyPlan-1.1" target="_blank">Project here</a>
                        </p> -->


                            
                        <p>金数据：</p>
                        <p>&emsp;&emsp;目前年级选项格式：'中班', '小班', '大班', '幼小衔接', '初一', '初二', '初三', <br>&emsp;&emsp;'高一', '高二', '高三', '1年级', '2年级' ,'3年级' ,'4年级' ,'5年级' ,'6年级' </p>
                        <p>&emsp;&emsp;列名格式：'目前年级', '您的微信昵称（方便发您计划）', '语文成绩','数学成绩','英语成绩',</p>
                        <p>&emsp;&emsp;“语文成绩”、“数学成绩”、“英语成绩”格式：填空简答题--数字、最小值0、最大值100、保留小数位数：1</p>
                        <p>&emsp;&emsp;需要在英语成绩问题前添加一个问题，“是否开始学习英语”，选项为“是”和“否”</p>
                        <p>规则设置：</p>
                        <p>&emsp;&emsp;问题“是否开始学习英语”，答案为“是”，则显示题目英语成绩</p>
                        <p>&emsp;&emsp;问题“目前年级”，答案为“1年级”、“2年级”，则显示“语文成绩”、“数学成绩”、“是否开始学习英语”</p>
                        <p>&emsp;&emsp;问题“目前年级”，答案为“3年级”、“4年级”、“5年级”、“6年级”，则显示“语文成绩”、“数学成绩”、“英语成绩”</p>
                        <p>&emsp;&emsp;<strong>必须严格按照这个格式命名！!建议直接复制这个指引里的列名。
                        </strong></p>




                        <p>改计划模板方法：</p>
                        <p>&emsp;&emsp;点击上方工具栏里的<a href="./model.html">模板更改（点我也可以哦）</a>，删除旧项目上传新项目。
                        </p><p>&emsp;&emsp;<strong>！每次上传尽量不要超过十个模板！</strong>

                        </p>

                        <!-- <p>&emsp;&emsp;提示: Project Directory Structure</p> -->
<!-- <ul>
    <li class="directory">studyPlan-1.1/
        <ul>
            <li class="directory">public/
                <ul>
                    <li class="file">index.html</li>
                    <li class="file">...</li>
                </ul>
            </li>
            <li class="directory">source/
                <ul>
                    <li class="file">中班学习计划.xlsx</li>
                    <li class="file">初一学习计划.xlsx</li>
                    <li class="file">1年级学习计划done.xlsx</li>
                    <li class="file">...</li> 
                </ul>
            </li>
            <li class="directory">uploads/</li>
            <li class="directory">processed/</li>
            <li class="file">server.js</li>
            <li class="file">package.json</li>
        </ul>
    </li>
</ul> -->
                            <p>
                                Deployment:
                            </p>
                            <div>此内容仅管理员可访问</div>

                            <!-- <p>
                        1.阿里云：
                    </p> -->
                    <!-- <p>
                        &emsp;&emsp; <strong>系统有效期到10月1号，在此前无续费自动释放。</strong>
                    </p> -->
                    <!-- <p>
                        &emsp;&emsp; 1.系统部署在阿里云ECS上，草莓熊手机扫码
                    </p>
                    <p>
                        &emsp;&emsp;&emsp;  位置：华北2（北京）
                    </p><p>
                        &emsp;&emsp;&emsp;  实例：i-2ze729yjvd9vjc45qa1e，
                    </p><p>
                        &emsp;&emsp;&emsp;  安全组ID：sg-2ze78247pezscertol49 
                </p> -->

                <!-- <p>
                    &emsp;&emsp;&emsp;  入站端口：暑期计划为3000，学期计划为4000
        </p>                <p>
            &emsp;&emsp; Workbench密码：见群内文档
        </p><p>
            &emsp;&emsp;&emsp;  放行入站IP表：
            </p><p>
                &emsp;&emsp;&emsp;  自主创新大厦 TAL-guest：111.204.240.2 
                </p>

                <p>
                    &emsp;&emsp;  2.文件部署位置为：/home/xes/studyPlan-1.1 (绝对路径)
                </p>
                <p>
                    &emsp;&emsp;  3.部署工具：pm2 进程名称：暑期计划：xes-plan 学期计划： xes-plan2
                    
                </p> -->
                <p>
                    &emsp;&emsp; 	pm2指令：
                    
                </p>             
            
<table>&emsp;&emsp;
    <tr>
        <th>指令</th>
        <th>说明</th>
        <th>示例</th>
    </tr>
    <tr>
        <td>npm install -g pm2</td>
        <td>安装 PM2</td>
        <td><code>npm install -g pm2</code></td>
    </tr>
    <tr>
        <td>pm2 start &lt;file&gt;</td>
        <td>启动应用</td>
        <td><code>pm2 start server.js --name study-plan-app</code></td>
    </tr>
    <tr>
        <td>pm2 list</td>
        <td>查看应用状态</td>
        <td><code>pm2 list</code></td>
    </tr>
    <tr>
        <td>pm2 restart &lt;name/id&gt;</td>
        <td>重启应用</td>
        <td><code>pm2 restart study-plan-app</code><br><code>pm2 restart &lt;id&gt;</code></td>
    </tr>
    <tr>
        <td>pm2 stop &lt;name/id&gt;</td>
        <td>停止应用</td>
        <td><code>pm2 stop study-plan-app</code><br><code>pm2 stop &lt;id&gt;</code></td>
    </tr>
    <tr>
        <td>pm2 delete &lt;name/id&gt;</td>
        <td>删除应用</td>
        <td><code>pm2 delete study-plan-app</code><br><code>pm2 delete &lt;id&gt;</code></td>
    </tr>
    <tr>
        <td>pm2 logs &lt;name/id&gt;</td>
        <td>查看日志</td>
        <td><code>pm2 logs study-plan-app</code><br><code>pm2 logs &lt;id&gt;</code></td>
    </tr>
    <tr>
        <td>pm2 save</td>
        <td>保存进程列表，便于重启后恢复</td>
        <td><code>pm2 save</code></td>
    </tr>
    <tr>
        <td>pm2 startup</td>
        <td>启用系统启动脚本，确保服务器重启后应用自动启动</td>
        <td><code>pm2 startup</code></td>
    </tr>
    <tr>
        <td>pm2 monit</td>
        <td>监控应用性能</td>
        <td><code>pm2 monit</code></td>
    </tr>
    <tr>
        <td>pm2 reload &lt;name/id&gt;</td>
        <td>0 秒停机重载应用（如果应用支持）</td>
        <td><code>pm2 reload study-plan-app</code><br><code>pm2 reload &lt;id&gt;</code></td>
    </tr>
</table>&emsp;&emsp;&emsp;

  
<!-- <p>
    &emsp;&emsp; 	具体部署方法见<a href="https://github.com/xhy783/studyPlan-1.1/blob/main/README.md" target="_blank">githubREADME文档</a>（复制在下方了），云端和本地部署方法基本一样，记得设置安全组！
</p>     -->

<h3>Study Plan Management System</h3>
<!-- <p>下面有中文版</p> -->


<h4>Overview</h4>
<p>This project is a web-based file management system designed for our teachers to upload user information via CSV files. The system generates study plans for each parent based on the uploaded data. Additionally, it includes a file management system allowing administrators to update source files, which let teachers change templates.</p>

<h4>Features</h4>
<ul>
    <li>Upload CSV Files: Teachers can upload CSV files containing user information.</li>
    <li>Generate Study Plans: The system processes the CSV file and generates personalized study plans for each parent.</li>
    <li>File Management: Administrators can upload, view, and delete template files in the source directory.</li>
    <li>Multi-level Handling: Handles different student performance levels (e.g., 111, 222, 333) (no need during Summery Vacation).</li>
</ul>

<h4>Prerequisites</h4>
<ul>
    <li>Node.js (version 12 or higher)</li>
    <li>npm (Node Package Manager)</li>
</ul>

<h4>Installation</h4>

<!-- <h5>Windows</h5>
<ol>
    <li>Install Node.js:
        <p>Download and install Node.js from <a href="https://nodejs.org/" target="_blank">nodejs.org</a>.</p>
    </li>
    <li>Clone the repository:
        <pre><code>git clone https://github.com/xhy783/studyPlan-1.2.git
            cd /home/xes/studyPlan-1.1</code></pre>
            <p>此内容仅管理员可访问</p>

    </li>
    <li>Install dependencies:
        <pre><code>npm install</code></pre>
    </li>
</ol>

<h5>macOS</h5>
<ol>
    <li>Install Node.js:
        <p>You can use Homebrew (recommended) to install Node.js. If you don't have Homebrew installed, you can install it from <a href="https://brew.sh/" target="_blank">brew.sh</a>.</p>
        <pre><code>brew install node</code></pre>
    </li>
    <li>Clone the repository:
        <pre><code>git clone https://github.com/xhy783/studyPlan-1.2.git
            cd /home/xes/studyPlan-1.2</code></pre>
            <p>此内容仅管理员可访问</p>

    </li>
    <li>Install dependencies:
        <pre><code>npm install</code></pre>
    </li>
</ol>

<h5>Linux</h5> -->
<ol>
    <li>Install Node.js:
        <p>On Debian-based distributions (e.g., Ubuntu), you can use:</p>
        <pre><code>sudo apt update
sudo apt install nodejs npm</code></pre>
        <p>On RHEL-based distributions (e.g., CentOS), you can use:</p>
        <pre><code>sudo yum install nodejs npm</code></pre>
    </li>
    <li>Clone the repository:
        <!-- <pre><code>git clone https://github.com/xhy783/studyPlan-1.2.git
            cd /home/xes/studyPlan-1.2</code></pre> -->
            <p>此内容仅管理员可访问</p>

    </li>
    <li>Install dependencies:
        <pre><code>npm install</code></pre>
    </li>
</ol>

<h4>Usage</h4>

<h5>Start the Server</h5>
<p>In the project directory, run the following command:</p>
<pre><code>node server.js</code></pre>

<h5>Access the Web Interface</h5>
<p>Open your web browser and navigate to <code>http://localhost:4000/model.html</code>.</p>

<h4>Project Structure</h4>
<pre><code>studyPlan-1.1/
├── public/
│   ├── css/
│   │   └── style.css
│   ├── index.html
│   ├── create.html
│   ├── instruction.html
│   ├── server.html
│   └── model.html
├── uploads/
│   └── (uploaded files)
├── source/
│   ├── 中班暑期学习计划.xlsx
│   ├── 初一暑期学习计划.xlsx
│   ├── 1231年级暑期学习计划done.xlsx
│   ├── 高一暑期学习计划.xlsx
│   └── ...
├── processed/
│   └── (processed files for download)
├── server.js
├── package.json
└── README.md</code></pre>

<h4>Modifying Templates</h4>

<h5>Updating Templates</h5>
<p>To update the templates, replace the existing files in the <code>source</code> directory with the new templates. The templates should follow the naming convention required by the specific logic in the <code>server.js</code> file. Or you can just easily go to the model.html and delete old templates and upload new templates (See Uploading New Templates).</p>

<h5>Code Changes</h5>
<!-- <p>If we don't change the logic of Summer vacation plans like all plans of the same grade possess the same content, we don't need to change codes. If the template filenames or logic for selecting templates change, you need to update the <code>processFile</code> function in <code>server.js</code>.</p>

<h6>Example: Grade 1-6 with Levels 111-333</h6>
<pre><code>const processFile = (filePath, processedFolder, callback) => {
    const results = [];
    fs.createReadStream(filePath)
        .pipe(csv())
        .on('data', (data) => results.push(data))
        .on('end', () => {
            results.forEach(row => {
                const grade = row['目前年级'];
                const wechatId = row['您的微信昵称（方便发您计划）'];
                let code = '';
                let sourceFile = '';

                if (['1年级', '2年级', '3年级', '4年级', '5年级', '6年级'].includes(grade)) {
                    const chineseScore = row['语文成绩'];
                    const mathScore = row['数学成绩'];
                    const englishScore = row['英语成绩'];

                    if (chineseScore === '96以上') {
                        code += '1';
                    } else if (chineseScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (mathScore === '96以上') {
                        code += '1';
                    } else if (mathScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (englishScore === '96以上') {
                        code += '1';
                    } else if (englishScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    sourceFile = `${code}${grade[0]}年级学习计划done.xlsx`;
                } else {
                    sourceFile = `${grade}暑期学习计划.xlsx`;
                }

                const sourcePath = path.join(__dirname, 'source', sourceFile);
                const targetFile = `${grade}暑期学习计划-${wechatId}.xlsx`;
                const targetPath = path.join(processedFolder, targetFile);

                try {
                    fs.copyFileSync(sourcePath, targetPath);
                    console.log(`File copied: ${targetPath}`);
                } catch (err) {
                    console.error(`Error while copying ${sourcePath} to ${targetPath}:`, err);
                }
            });
            callback();
        });
};</code></pre> -->
<!-- 
<h6>Example: Middle School with Levels</h6>
<p>If middle school grades (e.g., 初一, 初二, 初三) also require level-specific templates, update the <code>processFile</code> function accordingly:</p>
<pre><code>const processFile = (filePath, processedFolder, callback) => {
    const results = [];
    fs.createReadStream(filePath)
        .pipe(csv())
        .on('data', (data) => results.push(data))
        .on('end', () => {
            results.forEach(row => {
                const grade = row['目前年级'];
                const wechatId = row['您的微信昵称（方便发您计划）'];
                let code = '';
                let sourceFile = '';

                if (['初一', '初二', '初三'].includes(grade)) {
                    const chineseScore = row['语文成绩'];
                    const mathScore = row['数学成绩'];
                    const englishScore = row['英语成绩'];

                    if (chineseScore === '96以上') {
                        code += '1';
                    } else if (chineseScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (mathScore === '96以上') {
                        code += '1';
                    } else if (mathScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (englishScore === '96以上') {
                        code += '1';
                    } else if (englishScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    sourceFile = `${code}${grade}学习计划done.xlsx`;
                } else {
                    sourceFile = `${grade}暑期学习计划.xlsx`;
                }

                const sourcePath = path.join(__dirname, 'source', sourceFile);
                const targetFile = `${grade}暑期学习计划-${wechatId}.xlsx`;
                const targetPath = path.join(processedFolder, targetFile);

                try {
                    fs.copyFileSync(sourcePath, targetPath);
                    console.log(`File copied: ${targetPath}`);
                } catch (err) {
                    console.error(`Error while copying ${sourcePath} to ${targetPath}:`, err);
                }
            });
            callback();
        });
};</code></pre> -->
<p>此内容仅管理员可访问</p>

<h5>Uploading New Templates</h5>
<!-- <ol>
    <li>Navigate to the File Management Page:
        <p>Open your web browser and go to <code>http://localhost:4000/model.html</code> (or IP of aliyun server, depends on where you want to deploy this system).</p>
    </li>
    <li>Upload New Templates:
        <p>Use the file upload interface to upload new template files. Ensure the filenames follow the required naming conventions.</p>
    </li>
    <li>Update the Code:
        <p>If the logic for selecting templates has changed, update the <code>processFile</code> function in <code>server.js</code>.</p>
    </li>
    <li>Restart the Server:
        <p>After making changes to <code>server.js</code>, restart the server:</p>
        <pre><code>node server.js</code></pre>
        <p>(on aliyun's server I use pm2 to manage processes so I can do <code>pm2 restart xes-plan2</code>)</p>
    </li>
</ol> -->
<p>此内容仅管理员可访问</p>


<h4>More Information</h4>
<p>Should you have any questions or need more information, please contact <a href="mailto:xhy783@outlook.fr">xhy783@outlook.fr</a>.</p>
       
<!-- 

<h3>学习计划管理系统</h3>

<h4>概述</h4>
<p>本项目是一个基于Web的文件管理系统，旨在让教师通过CSV文件上传用户信息。系统根据上传的数据为每位家长生成学习计划。此外，系统还包括一个文件管理系统，允许管理员更新源文件，从而让教师更改模板。</p>

<h4>功能</h4>
<ul>
    <li>上传CSV文件：教师可以上传包含用户信息的CSV文件。</li>
    <li>生成学习计划：系统处理CSV文件并为每位家长生成个性化的学习计划。</li>
    <li>文件管理：管理员可以在源目录中上传、查看和删除模板文件。</li>
    <li>多层次处理：处理不同学生的成绩等级（例如，111，222，333）（暑期不需要）。</li>
</ul>

<h4>先决条件</h4>
<ul>
    <li>Node.js（版本12或更高）</li>
    <li>npm（Node包管理器）</li>
</ul>

<h4>安装</h4>

<h5>Windows</h5>
<ol>
    <li>安装Node.js：
        <p>从 <a href="https://nodejs.org/" target="_blank">nodejs.org</a> 下载并安装Node.js。</p>
    </li>
    <li>克隆仓库：
        <pre><code>git clone https://github.com/xhy783/studyPlan-1.2.git
            cd /home/xes/studyPlan-1.2</code></pre>
    </li>
    <li>安装依赖：
        <pre><code>npm install</code></pre>
    </li>
</ol>

<h5>macOS</h5>
<ol>
    <li>安装Node.js：
        <p>你可以使用Homebrew（推荐）安装Node.js。如果你没有安装Homebrew，可以从 <a href="https://brew.sh/" target="_blank">brew.sh</a> 安装。</p>
        <pre><code>brew install node</code></pre>
    </li>
    <li>克隆仓库：
        <pre><code>git clone https://github.com/xhy783/studyPlan-1.2.git
            cd /home/xes/studyPlan-1.2</code></pre>
    </li>
    <li>安装依赖：
        <pre><code>npm install</code></pre>
    </li>
</ol>

<h5>Linux</h5>
<ol>
    <li>安装Node.js：
        <p>在基于Debian的发行版（例如Ubuntu）上，可以使用：</p>
        <pre><code>sudo apt update
sudo apt install nodejs npm</code></pre>
        <p>在基于RHEL的发行版（例如CentOS）上，可以使用：</p>
        <pre><code>sudo yum install nodejs npm</code></pre>
    </li>
    <li>克隆仓库：
        <pre><code>git clone https://github.com/xhy783/studyPlan-1.2.git
            cd /home/xes/studyPlan-1.2</code></pre>
    </li>
    <li>安装依赖：
        <pre><code>npm install</code></pre>
    </li>
</ol>

<h4>使用方法</h4>

<h5>启动服务器</h5>
<p>在项目目录中运行以下命令：</p>
<pre><code>node server.js</code></pre>

<h5>访问Web界面</h5>
<p>打开你的Web浏览器，导航到 <code>http://localhost:4000/model.html</code>。</p>

<h4>项目结构</h4>
<pre><code>studyPlan-1.1/
├── public/
│   ├── css/
│   │   └── style.css
│   ├── index.html
│   ├── create.html
│   ├── instruction.html
│   ├── server.html
│   └── model.html
├── uploads/
│   └── (上传的文件)
├── source/
│   ├── 中班学习计划.xlsx
│   ├── 初一学习计划.xlsx
│   ├── 1231年级学习计划done.xlsx
│   ├── 高一学习计划.xlsx
│   └── ...
├── processed/
│   └── (处理后的文件用于下载)
├── server.js
├── package.json
└── README.md</code></pre>

<h4>修改模板</h4>

<h5>更新模板</h5>
<p>要更新模板，请将 <code>source</code> 目录中的现有文件替换为新模板。模板应遵循 <code>server.js</code> 文件中特定逻辑要求的命名约定。或者，你可以直接访问 <code>model.html</code>，删除旧模板并上传新模板（见上传新模板）。</p>

<h5>代码更改</h5>
<p>如果我们不更改暑期计划的逻辑，例如同一年级的所有计划内容相同，那么我们不需要更改代码。如果模板文件名或选择模板的逻辑发生变化，你需要更新 <code>server.js</code> 中的 <code>processFile</code> 函数。</p>

<h6>示例：等级1-6和级别111-333</h6>
<pre><code>const processFile = (filePath, processedFolder, callback) => {
    const results = [];
    fs.createReadStream(filePath)
        .pipe(csv())
        .on('data', (data) => results.push(data))
        .on('end', () => {
            results.forEach(row => {
                const grade = row['目前年级'];
                const wechatId = row['您的微信昵称（方便发您计划）'];
                let code = '';
                let sourceFile = '';

                if (['1年级', '2年级', '3年级', '4年级', '5年级', '6年级'].includes(grade)) {
                    const chineseScore = row['语文成绩'];
                    const mathScore = row['数学成绩'];
                    const englishScore = row['英语成绩'];

                    if (chineseScore === '96以上') {
                        code += '1';
                    } else if (chineseScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (mathScore === '96以上') {
                        code += '1';
                    } else if (mathScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (englishScore === '96以上') {
                        code += '1';
                    } else if (englishScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    sourceFile = `${code}${grade[0]}年级学习计划done.xlsx`;
                } else {
                    sourceFile = `${grade}暑期学习计划.xlsx`;
                }

                const sourcePath = path.join(__dirname, 'source', sourceFile);
                const targetFile = `${grade}暑期学习计划-${wechatId}.xlsx`;
                const targetPath = path.join(processedFolder, targetFile);

                try {
                    fs.copyFileSync(sourcePath, targetPath);
                    console.log(`File copied: ${targetPath}`);
                } catch (err) {
                    console.error(`Error while copying ${sourcePath} to ${targetPath}:`, err);
                }
            });
            callback();
        });
};</code></pre>

<h6>示例：初中和级别</h6>
<p>如果初中年级（例如，初一、初二、初三）也需要特定级别的模板，请相应更新 <code>processFile</code> 函数：</p>
<pre><code>const processFile = (filePath, processedFolder, callback) => {
    const results = [];
    fs.createReadStream(filePath)
        .pipe(csv())
        .on('data', (data) => results.push(data))
        .on('end', () => {
            results.forEach(row => {
                const grade = row['目前年级'];
                const wechatId = row['您的微信昵称（方便发您计划）'];
                let code = '';
                let sourceFile = '';

                if (['初一', '初二', '初三'].includes(grade)) {
                    const chineseScore = row['语文成绩'];
                    const mathScore = row['数学成绩'];
                    const englishScore = row['英语成绩'];

                    if (chineseScore === '96以上') {
                        code += '1';
                    } else if (chineseScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (mathScore === '96以上') {
                        code += '1';
                    } else if (mathScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    if (englishScore === '96以上') {
                        code += '1';
                    } else if (englishScore === '90-95') {
                        code += '2';
                    } else {
                        code += '3';
                    }

                    sourceFile = `${code}${grade}学习计划done.xlsx`;
                } else {
                    sourceFile = `${grade}暑期学习计划.xlsx`;
                }

                const sourcePath = path.join(__dirname, 'source', sourceFile);
                const targetFile = `${grade}暑期学习计划-${wechatId}.xlsx`;
                const targetPath = path.join(processedFolder, targetFile);

                try {
                    fs.copyFileSync(sourcePath, targetPath);
                    console.log(`File copied: ${targetPath}`);
                } catch (err) {
                    console.error(`Error while copying ${sourcePath} to ${targetPath}:`, err);
                }
            });
            callback();
        });
};</code></pre>

<h5>上传新模板</h5>
<ol>
    <li>导航到文件管理页面：
        <p>打开你的Web浏览器并转到 <code>http://localhost:4000/model.html</code>（或者根据你部署系统的位置使用阿里云服务器的IP地址）。</p>
    </li>
    <li>上传新模板：
        <p>使用文件上传界面上传新模板文件。确保文件名遵循所需的命名约定。</p>
    </li>
    <li>更新代码：
        <p>如果选择模板的逻辑发生了变化，请更新 <code>server.js</code> 中的 <code>processFile</code> 函数。</p>
    </li>
    <li>重启服务器：
        <p>在修改 <code>server.js</code> 后，重启服务器：</p>
        <pre><code>node server.js</code></pre>
        <p>（在阿里云服务器上，我使用 pm2 来管理进程，因此可以执行 <code>pm2 restart xes-plan2</code>）</p>
    </li>
</ol>

<h4>更多信息</h4>
<p>如果您有任何问题或需要更多信息，请联系 <a href="mailto:xhy783@outlook.fr">xhy783@outlook.fr</a>。</p>

            
            </div>


                          
        </div>

    </div>

        <div class="footer-notice">
            V1.2 学期计划专用        </div>
        
                    
    </div>
<script>    document.addEventListener('DOMContentLoaded', function() {
    var saveButton = document.getElementById('Trip');

    saveButton.addEventListener('click', function() {
        window.location.href = 'package.html';
    });
});
</script>
<script>
    function uploadFile() {
        var fileInput = document.getElementById('fileToUpload');
        var file = fileInput.files[0];
        var formData = new FormData();
        formData.append('fileToUpload', file);

        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'upload', true);

        xhr.onload = function () {
            if (xhr.status === 200) {
                var link = document.createElement('a');
                link.href = window.URL.createObjectURL(new Blob([xhr.response], {type: 'application/zip'}));
                link.download = 'processed_files.zip';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                document.getElementById('status').innerText = 'File uploaded and processed successfully!';
            } else {
                document.getElementById('status').innerText = 'File upload failed!';
            }
        };

        xhr.responseType = 'blob';
        xhr.send(formData);
    }
</script>



</body>
</html>

 -->
